<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iRaceResults</title>
    <link rel="stylesheet" href="/style.css">
    <style>
        body {
            background: #2b2b2b;
        }

        .title {
            text-align: left;
            font-size: 28px;
            
            color: #fff;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: left;
            font-size: 18px;
            color: #ccc;
            margin-bottom: 10px;
            margin-top: 30px;
        }

        .racing-icon-small {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            padding: 20px;
        }

        .link-btn {
            display: inline-block;
            background-color: #4285f4;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(66, 133, 244, 0.3);
        }

        .link-btn:hover {
            background-color: #357ae8;
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(66, 133, 244, 0.4);
        }

        .link-btn:active {
            transform: translateY(0);
        }
    </style>
</head>

<body>
    <div class="title">
        <span class="racing-icon-small">üèÅ</span>
        <b>iRaceResults</b> &nbsp; <small> League Management and Tables display system for iRacing Leagues</small>
        <span style="float: right; font-size: 14px; margin-right: 20px;"><i>by Paul Williams</i></span>
    </div>

    <div class="subtitle">
        <b>Select a League below to display League Tables</b>
    </div>

    <div style="max-width: 800px; margin: 0 10px; padding: 10px;">
        <div id="active-leagues-section" style="margin-bottom: 40px;">
            <h2 style="color: #4285f4; margin-bottom: 15px; font-size: 18px;">Active Leagues</h2>
            <div id="active-leagues-list" style="background: #1a1a1a; padding: 20px; border-radius: 8px; min-height: 50px;">
                <!-- Active leagues will be generated dynamically -->
            </div>
        </div>

        <div id="completed-leagues-section">
            <h2 style="color: #888; margin-bottom: 15px; font-size: 18px;">Completed Leagues</h2>
            <div id="completed-leagues-list" style="background: #1a1a1a; padding: 20px; border-radius: 8px; min-height: 50px;">
                <!-- Completed leagues will be generated dynamically -->
            </div>
        </div>
    </div>

    <script>
        // Fetch available leagues from the server (filtered by status)
        fetch('/leaguelist')
            .then(response => response.json())
            .then(leagues => {
                const activeContainer = document.getElementById('active-leagues-list');
                const completedContainer = document.getElementById('completed-leagues-list');

                // Separate leagues by status
                const activeLeagues = leagues.filter(league => league.league_status === 1);
                const completedLeagues = leagues.filter(league => league.league_status === 2);

                // Display active leagues
                if (activeLeagues.length === 0) {
                    activeContainer.innerHTML = '<p style="color: #888; text-align: center;">No active leagues</p>';
                } else {
                    activeLeagues.forEach(league => {
                        const link = document.createElement('a');
                        link.href = `./${league.leagueID}/`;
                        link.style.cssText = 'display: block; color: #4285f4; padding: 12px; margin: 5px 0; background: #2a2a2a; border-radius: 5px; text-decoration: none; font-size: 16px; transition: all 0.3s ease;';
                        link.textContent = league.league_name;
                        link.onmouseover = function() {
                            this.style.background = '#357ae8';
                            this.style.color = '#fff';
                            this.style.paddingLeft = '20px';
                        };
                        link.onmouseout = function() {
                            this.style.background = '#2a2a2a';
                            this.style.color = '#4285f4';
                            this.style.paddingLeft = '12px';
                        };
                        activeContainer.appendChild(link);
                    });
                }

                // Display completed leagues
                if (completedLeagues.length === 0) {
                    completedContainer.innerHTML = '<p style="color: #888; text-align: center;">No completed leagues</p>';
                } else {
                    completedLeagues.forEach(league => {
                        const link = document.createElement('a');
                        link.href = `./${league.leagueID}/`;
                        link.style.cssText = 'display: block; color: #888; padding: 12px; margin: 5px 0; background: #2a2a2a; border-radius: 5px; text-decoration: none; font-size: 16px; transition: all 0.3s ease;';
                        link.textContent = league.league_name;
                        link.onmouseover = function() {
                            this.style.background = '#666';
                            this.style.color = '#fff';
                            this.style.paddingLeft = '20px';
                        };
                        link.onmouseout = function() {
                            this.style.background = '#2a2a2a';
                            this.style.color = '#888';
                            this.style.paddingLeft = '12px';
                        };
                        completedContainer.appendChild(link);
                    });
                }
            })
            .catch(error => {
                console.error('Error fetching leagues:', error);
                document.getElementById('active-leagues-list').innerHTML =
                    '<p style="color: #f44336; text-align: center;">Error loading leagues</p>';
            });
    </script>
</body>

</html>